{"version":3,"file":"zForm.min.js","sources":["../src/storage.ts","../src/queue.ts","../src/script.ts"],"sourcesContent":[null,null,null],"names":["STORAGE_KEY","Storage","constructor","this","isAvailable","checkStorageAvailability","test","localStorage","setItem","removeItem","store","events","length","combined","retrieve","slice","JSON","stringify","error","stored","getItem","parse","clear","count","EventQueue","apiUrl","projectKey","batchSize","batchInterval","debug","queue","sendTimer","isSending","storage","loadStoredEvents","startBatchTimer","setupUnloadHandler","add","event","push","send","clearInterval","window","setInterval","batch","splice","payload","project_key","response","fetch","method","headers","body","keepalive","ok","Error","status","unshift","sendBeacon","blob","Blob","type","navigator","addEventListener","document","visibilityState","flush","destroy","zForms","config","formStates","Map","initialized","mutationObserver","api_url","batch_size","batch_interval","track_changes","debounce_time","sessionId","generateSessionId","init","readyState","setupTracking","attachListeners","setupDynamicFormTracking","setupAbandonmentTracking","MutationObserver","mutations","mutation","addedNodes","forEach","node","HTMLFormElement","attachFormListeners","HTMLElement","querySelectorAll","form","observe","childList","subtree","formId","getFormId","has","fields","formState","form_id","field_states","submitted","last_focused_field","total_fields","set","field","index","fieldId","getFieldId","element","field_id","focus_time","last_event","interaction_count","total_time_spent","has_value","hasFieldValue","validation_errors","field_element","WeakRef","blur_debounce_timer","handleFocus","handleBlur","handleChange","handleError","handleSubmit","HTMLInputElement","HTMLSelectElement","HTMLTextAreaElement","value","trim","fieldPosition","get","fieldState","Date","now","trackEvent","event_type","session_id","timestamp","toISOString","metadata","field_position","clearTimeout","setTimeout","timeSpent","deref","time_spent_ms","field_completed","hadValue","completedFields","totalInteractions","handleBeforeUnload","trackAbandonment","totalTimeSpent","fieldsWithErrors","abandonmentPosition","currentIndex","abandonment_field","id","getAttribute","Array","from","indexOf","Math","random","toString","substr","sessionStorage","track","eventType","includes","getSessionAnalytics","forms","values","map","completed_fields","total_interactions","disconnect","scriptTag","currentScript","instance","undefined","hasAttribute","zFormsClass"],"mappings":"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"}