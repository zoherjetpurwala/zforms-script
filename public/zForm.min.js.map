{"version":3,"file":"zForm.min.js","sources":["../src/storage.ts","../src/queue.ts","../src/script.ts"],"sourcesContent":[null,null,null],"names":["STORAGE_KEY","Storage","constructor","this","isAvailable","checkStorageAvailability","test","localStorage","setItem","removeItem","_a","store","events","length","combined","retrieve","slice","JSON","stringify","error","stored","getItem","parse","clear","count","EventQueue","apiUrl","projectKey","batchSize","batchInterval","debug","queue","sendTimer","isSending","storage","loadStoredEvents","startBatchTimer","setupUnloadHandler","add","event","push","send","clearInterval","window","setInterval","batch","splice","payload","project_key","response","fetch","method","headers","body","keepalive","ok","Error","status","unshift","sendBeacon","blob","Blob","type","navigator","addEventListener","document","visibilityState","flush","destroy","zForms","config","fieldStates","Map","initialized","api_url","batch_size","batch_interval","sessionId","generateSessionId","init","readyState","attachListeners","querySelectorAll","forEach","form","formId","getFormId","field","fieldId","getFieldId","stateKey","set","field_id","focus_time","last_event","handleFocus","handleBlur","handleError","handleSubmit","setupAbandonmentTracking","state","get","Date","now","trackEvent","form_id","event_type","session_id","timestamp","toISOString","timeSpent","time_spent_ms","hasInteracted","e","target","matches","closest","Array","from","values","some","id","getAttribute","indexOf","Math","random","toString","substr","sessionStorage","track","eventType","includes","scriptTag","currentScript","instance","undefined","hasAttribute","zFormsClass"],"mappings":"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"}